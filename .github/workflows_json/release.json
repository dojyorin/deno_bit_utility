{
    "name": "Release",
    "on": {
        "push": {
            "tags": "v[0-9]+.[0-9]+.[0-9]+"
        }
    },
    "jobs": {
        "release": {
            "name": "Release: ${{github.ref_name}}",
            "runs-on": "ubuntu-latest",
            "steps": [{
                "name": "clone repository",
                "uses": "actions/checkout@v3"
            }, {
                "name": "install deno",
                "uses": "denoland/setup-deno@v1",
                "with": {
                    "deno-version": "v1.x"
                }
            }, {
                "name": "install esbuild",
                "run": "curl -L `curl -L https://esbuild.github.io/dl/latest | grep -o -E 'https:.+?linux-x64.+?-[0-9]+\\.[0-9]+\\.[0-9]+\\.tgz'` | tar x -z --strip-components 2"
            }, {
                "name": "bundle deno module",
                "run": "deno bundle ./mod.ts | ./esbuild --minify | head -c -1 > ./deno.min.js"
            }, {
                "name": "bundle universal module",
                "run": "deno bundle ./mod.universal.ts | ./esbuild --minify | head -c -1 > ./universal.min.js"
            }, {
                "name": "dispatch release",
                "uses": "softprops/action-gh-release@v1",
                "with": {
                    "generate_release_notes": true,
                    "files": "./deno.min.js\n./universal.min.js"
                }
            }]
        }
    }
}